export const getActiveKeys = internalQuery({ ... });
export const incrementUsage = internalMutation({
  args: {
    keyId: v.id("brevoApiKeys"),
  },
  handler: async (ctx, args) => {
    const keys = await ctx.runQuery(internal.brevoQueries.getActiveKeys, {});
    // ...
  },
});

brevoApiKeys: defineTable({
  apiKey: v.string(),
  label: v.optional(v.string()),
  isActive: v.boolean(),
  dailyLimit: v.optional(v.number()),
  usageCount: v.number(),
  lastUsedAt: v.optional(v.number()),
  lastResetAt: v.number(),
  order: v.number(), // For rotation order
}).index("by_active", ["isActive"]).index("by_order", ["order"]),

emailTemplates: defineTable({
  name: v.string(),
  subject: v.string(),
  content: v.string(), // HTML content
  createdBy: v.id("users"),
  lastModifiedAt: v.number(),
}).index("by_name", ["name"]),

// WhatsApp Templates
templates: defineTable({
// ... keep existing code